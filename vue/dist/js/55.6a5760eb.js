"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[55],{9062:function(t,e,i){i.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"card"},[e("h2",{staticStyle:{"margin-bottom":"20px"}},[t._v("评论 "+t._s(t.commentCount))]),e("div",{staticStyle:{"margin-bottom":"20px"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入评论内容"},model:{value:t.commentContent,callback:function(e){t.commentContent=e},expression:"commentContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addComment.apply(null,arguments)}}},[e("el-button",{attrs:{type:"primary"},on:{click:t.addComment}},[t._v("评 论")])],1)],1),e("div",t._l(t.commentList,(function(i){return e("div",{key:i.id,staticStyle:{display:"flex","grid-gap":"20px","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:i.avatar,alt:""}}),e("div",{staticStyle:{flex:"1"}},[e("div",{staticStyle:{"margin-bottom":"10px"}},[e("div",{staticStyle:{color:"#666","margin-bottom":"10px"}},[t._v(t._s(i.userName))]),e("div",{staticStyle:{color:"#444","margin-bottom":"10px"}},[t._v(t._s(i.content))]),e("div",{staticStyle:{color:"#888","font-size":"13px","margin-bottom":"10px"}},[e("span",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(i.time))]),e("span",{class:{"comment-active":i.showReplyInput},staticStyle:{cursor:"pointer"},on:{click:function(e){return t.handleShowshowReplyInput(i)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("评论")]),i.userId===t.user.id?e("span",{staticStyle:{"margin-left":"20px",cursor:"pointer"},on:{click:function(e){return t.del(i.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()])]),i.showReplyInput?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复内容"},model:{value:i.replyContent,callback:function(e){t.$set(i,"replyContent",e)},expression:"item.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addReplay(i)}}},[t._v("回 复")])],1)],1):t._e(),t._l(i.children,(function(s){return e("div",{key:i.id,staticStyle:{display:"flex","grid-gap":"20px","margin-bottom":"20px"}},[e("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:s.avatar,alt:""}}),e("div",{staticStyle:{flex:"1"}},[e("div",{staticStyle:{color:"#666","margin-bottom":"10px"}},[t._v(t._s(s.userName)+" "),s.replyUser!==i.userName?e("span",{staticStyle:{color:"#333"}},[t._v("回复 "+t._s(s.replyUser))]):t._e()]),e("div",{staticStyle:{color:"#444","margin-bottom":"10px"}},[t._v(t._s(s.content))]),e("div",{staticStyle:{color:"#888","font-size":"13px","margin-bottom":"10px"}},[e("span",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(s.time))]),e("span",{class:{"comment-active":s.showReplyInput},staticStyle:{cursor:"pointer"},on:{click:function(e){return t.handleShowshowReplyInput(s)}}},[e("i",{staticClass:"el-icon-s-comment"}),t._v("评论")]),s.userId===t.user.id?e("span",{staticStyle:{"margin-left":"20px",cursor:"pointer"},on:{click:function(e){return t.del(s.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v("删除")]):t._e()]),s.showReplyInput?e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"请输入回复内容"},model:{value:s.replyContent,callback:function(e){t.$set(s,"replyContent",e)},expression:"sub.replyContent"}}),e("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addReplay(s)}}},[t._v("回 复")])],1)],1):t._e()])])}))],2)])})),0)])},n=[],a={name:"CommentComponent",props:{fid:null,module:null},data(){return{commentCount:0,commentContent:"",commentList:[],user:JSON.parse(localStorage.getItem("xm-user")||"{}")}},created(){this.loadComment()},methods:{del(t){this.$confirm("您确定删除吗？","确认删除",{type:"warning"}).then((e=>{this.$request.delete("/comment/delete/"+t).then((t=>{"200"===t.code?this.loadComment():this.$message.error(t.msg)}))})).catch((()=>{}))},loadComment(){this.$request.get("/comment/selectForUser",{params:{fid:this.fid,module:this.module}}).then((t=>{this.commentList=t.data||[]})),this.$request.get("/comment/selectCount",{params:{fid:this.fid,module:this.module}}).then((t=>{this.commentCount=t.data||0}))},handleShowshowReplyInput(t){this.$set(t,"showReplyInput",!t.showReplyInput)},addReplay(t){this.$request.post("/comment/add",{content:t.replyContent,rootId:t.rootId,fid:this.fid,module:this.module,pid:t.id}).then((e=>{"200"===e.code&&(t.replyContent="",this.loadComment())}))},addComment(){""!==this.commentContent?"666"!==this.user.username?this.$request.post("/comment/add",{content:this.commentContent,fid:this.fid,module:this.module}).then((t=>{"200"===t.code&&(this.commentContent="",this.loadComment())})):this.$message.error("访客不能评论，请先登录哦"):this.$message.error("评论为空")}}},o=a,l=i(3736),r=(0,l.Z)(o,s,n,!1,null,"4618ddcc",null),c=r.exports},3055:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content",staticStyle:{width:"60%"}},[e("div",{staticClass:"card",staticStyle:{"margin-bottom":"10px"}},[e("div",{staticStyle:{display:"flex","grid-gap":"20px"}},[e("img",{staticStyle:{width:"30%",height:"250px","border-radius":"5px"},attrs:{src:t.activity.cover,alt:""}}),e("div",{staticStyle:{flex:"1",position:"relative"}},[e("div",{staticStyle:{"font-weight":"bold","font-size":"24px","margin-bottom":"10px"}},[t._v(t._s(t.activity.name))]),e("div",{staticStyle:{color:"#666","font-size":"13px","line-height":"22px","text-align":"justify","margin-bottom":"10px"}},[t._v(t._s(t.activity.descr))]),e("div",{staticStyle:{color:"#666","margin-bottom":"10px"}},[e("i",{staticClass:"el-icon-date"}),t._v(" 时间 "),e("span",{staticStyle:{"margin-left":"5px"}},[t._v(t._s(t.activity.start)+" ~ "+t._s(t.activity.end))])]),e("div",{staticStyle:{color:"#666","margin-bottom":"10px"}},[e("i",{staticClass:"el-icon-location"}),t._v(" 商品地址 "),"线上"===t.activity.form?e("a",{staticStyle:{color:"#2a60c9","margin-left":"5px"},attrs:{href:t.activity.address,target:"_blank"}},[t._v(t._s(t.activity.address))]):e("span",{staticStyle:{"margin-left":"5px"}},[t._v(t._s(t.activity.address))]),e("el-tag",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"mini"}},[t._v(t._s(t.activity.form))])],1),e("div",{staticStyle:{position:"absolute",bottom:"0",width:"100%"}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("div",{staticStyle:{flex:"1"}},[t.activity.isEnd?e("el-button",{key:"已结束",attrs:{type:"primary",disabled:""}},[t._v("已结束")]):t.activity.isSign?e("el-button",{key:t.signText,attrs:{type:"success"},on:{click:t.cancel},nativeOn:{mouseenter:function(e){t.signText="取消报名"},mouseleave:function(e){t.signText="已报名"}}},[t._v(t._s(t.signText))]):e("el-button",{attrs:{type:"primary"},on:{click:t.sign}},[t._v("报 名")]),e("el-button",{staticStyle:{"margin-left":"5px","background-color":"green"},attrs:{type:"primary"},on:{click:t.redirectToExternalSite}},[t._v("购 买")])],1),e("div",{staticStyle:{"text-align":"right",flex:"1"}},[t.activity.isLike?e("el-button",{attrs:{type:"danger"},on:{click:t.like}},[t._v("已点赞 "+t._s(t.activity.likesCount))]):e("el-button",{attrs:{type:"danger"},on:{click:t.like}},[t._v("点赞 "+t._s(t.activity.likesCount))]),t.activity.isCollect?e("el-button",{attrs:{type:"warning"},on:{click:t.collect}},[t._v("已收藏 "+t._s(t.activity.collectCount))]):e("el-button",{attrs:{type:"warning"},on:{click:t.collect}},[t._v("收藏 "+t._s(t.activity.collectCount))]),e("el-button",{attrs:{type:"info"}},[t._v("阅读量 "+t._s(t.activity.readCount))])],1)])])])])]),e("div",{staticClass:"card",staticStyle:{"margin-bottom":"10px"}},[e("div",{staticStyle:{"font-weight":"bold","font-size":"24px","margin-bottom":"20px","padding-left":"10px","border-left":"5px solid #2a60c9"}},[t._v("活动详情")]),e("div",{staticClass:"w-e-text"},[e("div",{domProps:{innerHTML:t._s(t.activity.content)}})])]),e("div",[e("Comment",{attrs:{fid:t.activityId,module:"活动"}})],1)])},n=[],a=i(9062),o={name:"ActivityDetail",components:{Comment:a.Z},data(){return{activity:{},activityId:this.$route.query.activityId,signText:"已报名",user:JSON.parse(localStorage.getItem("xm-user")||"{}")}},created(){this.load(),this.$request.put("/activity/updateReadCount/"+this.activityId)},methods:{redirectToExternalSite(){"线上"===this.activity.form&&window.open(this.activity.address,"_blank")},cancel(){this.$confirm("您确定取消报名吗？","确认取消",{type:"warning"}).then((t=>{this.$request.delete("/activitySign/delete/user/"+this.activityId+"/"+this.user.id).then((t=>{"200"===t.code?this.load():this.$message.error(t.msg)}))})).catch((()=>{}))},collect(){this.$request.post("/collect/set",{fid:this.activityId,module:"活动"}).then((t=>{"200"===t.code?this.load():this.$message.error(t.msg)}))},like(){this.$request.post("/likes/set",{fid:this.activityId,module:"活动"}).then((t=>{"200"===t.code?this.load():this.$message.error(t.msg)}))},sign(){this.$request.post("/activitySign/add",{activityId:this.activityId}).then((t=>{"200"===t.code?this.load():this.$message.error(t.msg)}))},load(){this.$request.get("/activity/selectById/"+this.activityId).then((t=>{this.activity=t.data||{}}))}}},l=o,r=i(3736),c=(0,r.Z)(l,s,n,!1,null,"80fc440e",null),d=c.exports}}]);
//# sourceMappingURL=55.6a5760eb.js.map