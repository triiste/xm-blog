"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[458],{9458:function(t,e,o){o.r(e),o.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticStyle:{width:"380px",padding:"30px 30px","background-color":"rgba(255, 255, 255, 0.4)","border-radius":"5px"}},[e("div",{staticStyle:{"text-align":"center","font-size":"24px","margin-bottom":"30px",color:"#000b17","text-shadow":"0 0 10px rgba(53,217,81,0.33)"}},[t._v(" 计算机交流论坛 ")]),e("el-form",{ref:"formRef",attrs:{model:t.form,rules:t.rules}},[e("el-form-item",{attrs:{prop:"username"}},[e("el-input",{attrs:{size:"medium","prefix-icon":"el-icon-user",placeholder:"请输入账号"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{attrs:{size:"medium","prefix-icon":"el-icon-lock",placeholder:"请输入密码","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),e("el-form-item",{attrs:{prop:"role"}},[e("el-radio-group",{model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},[e("el-radio",{attrs:{label:"ADMIN"}},[t._v("管理员")]),e("el-radio",{attrs:{label:"USER"}},[t._v("用户")])],1)],1),e("el-form-item",{attrs:{prop:"code"}},[e("div",{staticStyle:{display:"flex"}},[e("el-input",{staticStyle:{flex:"1"},attrs:{size:"medium"},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}}),e("Identify",{attrs:{identifyCode:t.identifyCode},nativeOn:{click:function(e){return t.refreshCode.apply(null,arguments)}}})],1)]),e("el-form-item",[e("el-button",{staticStyle:{width:"100%","background-color":"#2a60c9","border-color":"#2a60c9",color:"white"},attrs:{size:"medium"},on:{click:t.login}},[t._v("登 录")])],1),e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("div",{staticStyle:{flex:"1"}}),e("div",{staticStyle:{flex:"1","text-align":"right"}})]),e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("el-button",{staticStyle:{"margin-left":"5px","font-size":"14px",color:"green","font-weight":"bold","background-color":"transparent",border:"none"},on:{click:t.visit}},[t._v("访客直接进入")]),e("div",{staticStyle:{flex:"1","text-align":"right"}},[t._v(" 还没有账号？请 "),e("a",{attrs:{href:"/register"}},[t._v("注册")])])],1)],1)],1)])},r=[],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"s-canvas"},[e("canvas",{attrs:{id:"s-canvas",width:t.contentWidth,height:t.contentHeight}})])},n=[],a={name:"Identify",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:28},fontSizeMax:{type:Number,default:40},backgroundColorMin:{type:Number,default:180},backgroundColorMax:{type:Number,default:240},colorMin:{type:Number,default:50},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:40},lineColorMax:{type:Number,default:180},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:112},contentHeight:{type:Number,default:35}},methods:{randomNum(t,e){return Math.floor(Math.random()*(e-t)+t)},randomColor(t,e){var o=this.randomNum(t,e),i=this.randomNum(t,e),r=this.randomNum(t,e);return"rgb("+o+","+i+","+r+")"},drawPic(){var t=document.getElementById("s-canvas"),e=t.getContext("2d");e.textBaseline="bottom",e.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),e.fillRect(0,0,this.contentWidth,this.contentHeight);for(let o=0;o<this.identifyCode.length;o++)this.drawText(e,this.identifyCode[o],o);this.drawLine(e),this.drawDot(e)},drawText(t,e,o){t.fillStyle=this.randomColor(this.colorMin,this.colorMax),t.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";var i=(o+1)*(this.contentWidth/(this.identifyCode.length+1)),r=this.randomNum(this.fontSizeMax,this.contentHeight-5),s=this.randomNum(-30,30);t.translate(i,r),t.rotate(s*Math.PI/270),t.fillText(e,0,0),t.rotate(-s*Math.PI/270),t.translate(-i,-r)},drawLine(t){for(let e=0;e<2;e++)t.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),t.beginPath(),t.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.stroke()},drawDot(t){for(let e=0;e<20;e++)t.fillStyle=this.randomColor(0,255),t.beginPath(),t.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),t.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},l=a,d=o(3736),h=(0,d.Z)(l,s,n,!1,null,"32112728",null),m=h.exports,c={name:"Login",components:{Identify:m},data(){return{form:{role:"USER"},form1:{role:"USER"},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},code:"",identifyCode:"",identifyCodes:"123456789ABCDEFGHGKMNPQRSTUVWXY"}},mounted(){this.refreshCode()},methods:{refreshCode(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},makeCode(t,e){for(let o=0;o<e;o++)this.identifyCode+=this.identifyCodes[Math.floor(Math.random()*this.identifyCodes.length)]},visit(){this.form1.username="666",this.form1.password="666",this.$request.post("/login",this.form1).then((t=>{console.log("到这没1有"),"200"===t.code&&(console.log("到这没2有"),localStorage.setItem("xm-user",JSON.stringify(t.data)),this.$message.success("访客模式"),setTimeout((()=>{location.href="/front/home"}),500))}))},login(){return this.code?this.code.toLowerCase()!==this.identifyCode.toLowerCase()?(this.$message.warning("验证码错误"),void this.refreshCode()):void this.$refs["formRef"].validate((t=>{t&&this.$request.post("/login",this.form).then((t=>{"200"===t.code?(localStorage.setItem("xm-user",JSON.stringify(t.data)),this.$message.success("登录成功"),setTimeout((()=>{"ADMIN"===t.data.role?location.href="/home":location.href="/front/home"}),500)):(this.refreshCode(),this.$message.error(t.msg))}))})):(this.$message.warning("请输入验证码"),void this.refreshCode())}}},f=c,u=(0,d.Z)(f,i,r,!1,null,"60b73d43",null),p=u.exports}}]);
//# sourceMappingURL=458.17ca7d02.js.map