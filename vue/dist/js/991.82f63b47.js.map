{"version":3,"file":"js/991.82f63b47.js","mappings":"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","sources":["webpack://vue/./src/views/front/ImSingle.vue","webpack://vue/./src/assets/emoji.js","webpack://vue/src/views/front/ImSingle.vue","webpack://vue/./src/views/front/ImSingle.vue?3033","webpack://vue/./src/views/front/ImSingle.vue?aef3"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"main-body-content center-container\",staticStyle:{\"margin-left\":\"400px\",\"margin-top\":\"50px\"}},[_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"flex-start\"}},[_c('div',{staticStyle:{\"width\":\"240px\",\"border\":\"1px solid #000b17\",\"border-radius\":\"5px\",\"height\":\"calc(50vh + 125px)\"}},[_c('div',{staticClass:\"header\"},[_vm._v(\"è®ºå›ç”¨æˆ·\")]),_c('div',{staticClass:\"user-list-box\",staticStyle:{\"height\":\"calc(50vh + 125px - 42px)\",\"overflow-y\":\"scroll\",\"background-color\":\"#f0f0f0\"}},_vm._l((_vm.users.USER),function(item){return _c('div',{staticClass:\"user-list-item\",on:{\"click\":function($event){return _vm.selectToUser(item)}}},[_c('img',{class:{ online: item.info === 'åœ¨çº¿', offline: item.info === 'ç¦»çº¿' },attrs:{\"src\":item.avatar}}),_c('span',{staticStyle:{\"flex\":\"1\",\"margin-left\":\"10px\",\"font-size\":\"16px\"},style:({ color: item.id.toString() === _vm.toUser.toString() ? '#3a8ee6' :''})},[_vm._v(\" \"+_vm._s(item.name)+\" \"),(item.info === 'åœ¨çº¿')?_c('span',{staticStyle:{\"color\":\"#4CAF50\"}},[_vm._v(\"åœ¨çº¿\")]):_c('span',{staticStyle:{\"color\":\"gray\"}},[_vm._v(\"ç¦»çº¿\")])]),(_vm.unRead?.[item.id ])?_c('div',{staticClass:\"user-list-item-badge\"},[_vm._v(_vm._s(_vm.unRead?.[item.id ]))]):_vm._e()])}),0)]),_c('div',{staticStyle:{\"width\":\"50%\",\"border\":\"1px solid #ddd\",\"border-radius\":\"5px\",\"background-color\":\"#f1f1f1\",\"margin\":\"0 10px\"}},[_c('div',{staticStyle:{\"padding\":\"20px 0\",\"text-align\":\"center\",\"border-bottom\":\"1px solid #ddd\",\"color\":\"#000\",\"background-color\":\"#eee\",\"height\":\"60px\"}},[_vm._v(\" \"+_vm._s(_vm.toUserName)+\" \")]),_c('div',{staticClass:\"im-message-box\"},_vm._l((_vm.groupedMessages),function(group,date){return _c('div',{key:date},_vm._l((group),function(item,index){return _c('div',{key:index},[(index === 0)?_c('div',{staticStyle:{\"text-align\":\"center\",\"font-weight\":\"bold\",\"margin-bottom\":\"5px\"}},[_vm._v(_vm._s(date))]):_vm._e(),(_vm.shouldDisplayTime(index, group))?_c('div',[_c('div',{staticStyle:{\"text-align\":\"center\"},domProps:{\"innerHTML\":_vm._s(item.time)}})]):_vm._e(),(item.fromuser === _vm.fromUser.toString())?_c('div',{staticStyle:{\"display\":\"flex\",\"flex-direction\":\"row-reverse\",\"align-items\":\"flex-start\"}},[_c('img',{staticStyle:{\"width\":\"40px\",\"height\":\"40px\",\"border-radius\":\"50%\",\"margin-left\":\"10px\"},attrs:{\"src\":item.fromavatar,\"alt\":\"\"}}),(item.type === 'text')?_c('div',{staticClass:\"im-message im-message-right\",domProps:{\"innerHTML\":_vm._s(item.content)}}):_vm._e(),(item.type === 'img')?_c('div',{staticClass:\"im-message\",staticStyle:{\"padding\":\"0\"}},[_c('el-image',{staticStyle:{\"width\":\"100px\"},attrs:{\"src\":item.content,\"alt\":\"\",\"preview-src-list\":[item.content]},on:{\"load\":_vm.scrollToBottom}})],1):_vm._e(),(item.type === 'file')?_c('div',{staticClass:\"im-message im-message-download\",on:{\"click\":function($event){return _vm.download(item.content)}}},[_c('div',[_c('i',{staticClass:\"el-icon-folder-opened\"}),_c('span',[_vm._v(_vm._s(item.content.substring(item.content.indexOf('-') + 1)))])])]):_vm._e()]):_c('div',{staticStyle:{\"display\":\"flex\",\"align-items\":\"flex-start\"}},[_c('img',{staticStyle:{\"width\":\"40px\",\"height\":\"40px\",\"border-radius\":\"50%\",\"margin-right\":\"10px\"},attrs:{\"src\":item.fromavatar,\"alt\":\"\"}}),_c('div',{staticStyle:{\"width\":\"100%\"}},[_c('div',{staticStyle:{\"color\":\"#888\",\"font-size\":\"12px\",\"width\":\"50%\"}},[_vm._v(\" \"+_vm._s(_vm.toUserName)+\" \")]),(item.type === 'text')?_c('div',{staticClass:\"im-message im-message-left\",domProps:{\"innerHTML\":_vm._s(item.content)}}):_vm._e(),(item.type === 'img')?_c('div',{staticClass:\"im-message\",staticStyle:{\"padding\":\"0\"}},[_c('el-image',{staticStyle:{\"width\":\"100px\"},attrs:{\"src\":item.content,\"alt\":\"\",\"preview-src-list\":[item.content]},on:{\"load\":_vm.scrollToBottom}})],1):_vm._e(),(item.type === 'file')?_c('div',{staticClass:\"im-message im-message-download\",on:{\"click\":function($event){return _vm.download(item.content)}}},[_c('div',[_c('i',{staticClass:\"el-icon-folder-opened\"}),_c('span',[_vm._v(_vm._s(item.content.substring(item.content.indexOf('-') + 1)))])])]):_vm._e()])])])}),0)}),0),_c('div',{staticStyle:{\"padding\":\"10px 5px\",\"border-top\":\"1px solid #ddd\",\"display\":\"flex\",\"align-items\":\"center\",\"width\":\"100%\"}},[_c('el-popover',{attrs:{\"placement\":\"top\",\"width\":\"300\",\"trigger\":\"click\"}},[_c('div',{staticClass:\"emoji-box\"},_vm._l((_vm.emojis),function(item,index){return _c('span',{key:index,staticStyle:{\"margin-right\":\"5px\",\"font-size\":\"20px\",\"cursor\":\"pointer\"},domProps:{\"innerHTML\":_vm._s(item)},on:{\"click\":function($event){return _vm.clickEmoji(item)}}})}),0),_c('i',{staticClass:\"fa fa-smile-o\",staticStyle:{\"font-size\":\"22px\",\"color\":\"#666\"},attrs:{\"slot\":\"reference\"},slot:\"reference\"})]),_c('div',{staticStyle:{\"margin-left\":\"5px\"}},[_c('el-upload',{attrs:{\"action\":\"http://47.109.28.131:9090/files/upload\",\"show-file-list\":false,\"on-success\":_vm.handleFile}},[_c('i',{staticClass:\"fa fa-folder-open-o\",staticStyle:{\"font-size\":\"20px\",\"color\":\"#666\"}})])],1),_c('div',{staticStyle:{\"flex\":\"1\",\"background-color\":\"#fff\",\"margin\":\"0 5px\",\"max-height\":\"50px\",\"overflow-y\":\"auto\",\"padding\":\"10px\",\"border\":\"1px solid #ddd\",\"border-radius\":\"2px\",\"outline\":\"none\",\"font-size\":\"18px\"},attrs:{\"id\":\"im-content\",\"contenteditable\":\"\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;$event.preventDefault();},\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.send.apply(null, arguments)}}}),_c('el-button',{staticStyle:{\"border\":\"none\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.send}},[_vm._v(\"å‘é€\")])],1)])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const emojis = \"ğŸ˜€,ğŸ˜,ğŸ˜‚,ğŸ˜ƒ,ğŸ˜„,ğŸ˜…,ğŸ˜†,ğŸ˜‰,ğŸ˜Š,ğŸ˜‹,ğŸ˜,ğŸ˜,ğŸ˜˜,ğŸ˜—,ğŸ˜™,ğŸ˜š,ğŸ˜‡,ğŸ˜,ğŸ˜‘,ğŸ˜¶,ğŸ˜,ğŸ˜£,ğŸ˜¥,ğŸ˜®,ğŸ˜¯,ğŸ˜ª,ğŸ˜«,ğŸ˜´,ğŸ˜Œ,ğŸ˜›,ğŸ˜œ,ğŸ˜,ğŸ˜’,ğŸ˜“,ğŸ˜”,ğŸ˜•,ğŸ˜²,ğŸ˜·,ğŸ˜–,ğŸ˜,ğŸ˜Ÿ,ğŸ˜¤,ğŸ˜¢,ğŸ˜­,ğŸ˜¦,ğŸ˜§,ğŸ˜¨,ğŸ˜¬,ğŸ˜°,ğŸ˜±,ğŸ˜³,ğŸ˜µ,ğŸ˜¡,ğŸ˜ ,ğŸ’˜,â¤,ğŸ’“,ğŸ’”,ğŸ’•,ğŸ’–,ğŸ’—,ğŸ’™,ğŸ’š,ğŸ’›,ğŸ’œ,ğŸ’,ğŸ’,ğŸ’Ÿ,â£,ğŸ’ª,ğŸ‘ˆ,ğŸ‘‰,â˜,ğŸ‘†,ğŸ‘‡,âœŒ,âœ‹,ğŸ‘Œ,ğŸ‘,ğŸ‘,âœŠ,ğŸ‘Š,ğŸ‘‹,ğŸ‘,ğŸ‘,âœ,ğŸ‡,ğŸˆ,ğŸ‰,ğŸŠ,ğŸ‹,ğŸŒ,ğŸ,ğŸ,ğŸ,ğŸ,ğŸ‘,ğŸ’,ğŸ“,ğŸ…,ğŸ†,ğŸŒ½,ğŸ„,ğŸŒ°,ğŸ,ğŸ–,ğŸ—,ğŸ”,ğŸŸ,ğŸ•,ğŸ³,ğŸ²,ğŸ±,ğŸ˜,ğŸ™,ğŸš,ğŸ›,ğŸœ,ğŸ,ğŸ ,ğŸ¢,ğŸ£,ğŸ¤,ğŸ¥,ğŸ¡,ğŸ¦,ğŸ§,ğŸ¨,ğŸ©,ğŸª,ğŸ‚,ğŸ°,ğŸ«,ğŸ¬,ğŸ­,ğŸ®,ğŸ¯,ğŸ¼,â˜•,ğŸµ,ğŸ¶,ğŸ·,ğŸ¸,ğŸ¹,ğŸº,ğŸ»,ğŸ´,ğŸŒ¹,ğŸ€,ğŸ,ğŸ’°,ğŸ“±,ğŸŒ™,ğŸ,ğŸ‚,ğŸƒ,ğŸŒ·,ğŸ’,ğŸ”ª,ğŸ”«,ğŸ€,âš½,âš¡,ğŸ‘„,ğŸ‘,ğŸ”¥,ğŸ™ˆ,ğŸ™‰,ğŸ™Š,ğŸµ,ğŸ’,ğŸ¶,ğŸ•,ğŸ©,ğŸº,ğŸ±,ğŸ˜º,ğŸ˜¸,ğŸ˜¹,ğŸ˜»,ğŸ˜¼,ğŸ˜½,ğŸ™€,ğŸ˜¿,ğŸ˜¾,ğŸˆ,ğŸ¯,ğŸ…,ğŸ†,ğŸ´,ğŸ,ğŸ®,ğŸ‚,ğŸƒ,ğŸ„,ğŸ·,ğŸ–,ğŸ—,ğŸ½,ğŸ,ğŸ‘,ğŸ,ğŸª,ğŸ«,ğŸ˜,ğŸ­,ğŸ,ğŸ€,ğŸ¹,ğŸ°,ğŸ‡,ğŸ»,ğŸ¨,ğŸ¼,ğŸ¾,ğŸ”,ğŸ“,ğŸ£,ğŸ¤,ğŸ¥,ğŸ¦,ğŸ§,ğŸ¸,ğŸŠ,ğŸ¢,ğŸ,ğŸ²,ğŸ‰,ğŸ³,ğŸ‹,ğŸ¬,ğŸŸ,ğŸ ,ğŸ¡,ğŸ™,ğŸš,ğŸŒ,ğŸ›,ğŸœ,ğŸ,ğŸ,ğŸ¦‹,ğŸ˜ˆ,ğŸ‘¿,ğŸ‘¹,ğŸ‘º,ğŸ’€,â˜ ,ğŸ‘»,ğŸ‘½,ğŸ‘¾,ğŸ’£\"\r\n\r\nexport default emojis","<template>\r\n  <div>\r\n    <div  class=\"main-body-content center-container\" style=\"margin-left: 400px;margin-top: 50px;\">\r\n      <div style=\"display: flex; align-items: flex-start;\" >\r\n        <!--        125px-->\r\n        <div style=\"width: 240px; border: 1px solid #000b17; border-radius: 5px; height: calc(50vh + 125px);\">\r\n          <div class=\"header\">è®ºå›ç”¨æˆ·</div>\r\n          <!--          å­¦ç”Ÿæ¡†-->\r\n          <div class=\"user-list-box\" style=\"height:calc(50vh + 125px - 42px);overflow-y: scroll;background-color: #f0f0f0\">\r\n\r\n\r\n            <div class=\"user-list-item\" v-for=\"item in users.USER\" @click=\"selectToUser(item)\">\r\n              <img :src=\"item.avatar\" :class=\"{ online: item.info === 'åœ¨çº¿', offline: item.info === 'ç¦»çº¿' }\">\r\n              <span style=\"flex: 1; margin-left: 10px;font-size: 16px\" :style=\"{ color: item.id.toString() === toUser.toString() ? '#3a8ee6' :''} \">\r\n              {{ item.name }}\r\n                <span v-if=\"item.info === 'åœ¨çº¿'\" style=\"color: #4CAF50;\">åœ¨çº¿</span>\r\n                <span v-else style=\"color: gray;\">ç¦»çº¿</span>\r\n             </span>\r\n\r\n              <div class=\"user-list-item-badge\" v-if=\"unRead?.[item.id ]\">{{ unRead?.[item.id ] }}</div>\r\n              <!--              è¡¨ç¤ºæœªè¯»æ•°é‡-->\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!--  ä¸­é—´éƒ¨åˆ†  -->\r\n        <div style=\"width: 50%; border: 1px solid #ddd; border-radius: 5px; background-color: #f1f1f1; margin: 0 10px;\">\r\n          <div style=\"padding: 20px 0; text-align: center; border-bottom: 1px solid #ddd; color: #000; background-color: #eee; height: 60px\">\r\n            {{ toUserName }}\r\n          </div>\r\n          <div class=\"im-message-box\">\r\n            <!--            éå†æ•´ä¸ªèŠå¤©è®°å½•-->\r\n            <div v-for=\"(group, date) in groupedMessages\" :key=\"date\">\r\n              <div v-for=\"(item, index) in group\" :key=\"index\">\r\n                <div v-if=\"index === 0\" style=\"text-align: center;font-weight: bold;margin-bottom: 5px\">{{ date }}</div>\r\n                <div v-if=\"shouldDisplayTime(index, group)\">\r\n                  <div style=\"text-align: center\" v-html=\"item.time\"></div>\r\n                </div>\r\n                <!--  å³è¾¹çš„æ°”æ³¡   åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯ä¸æ˜¯å‘é€è€…ï¼Œå¦‚æœæ˜¯å°±æ‰§è¡Œè¿™ä¸ª è‡ªå·±æ¥äº†å°±æ‰§è¡Œè¿™é‡Œ-->\r\n                <div style=\"display: flex; flex-direction: row-reverse; align-items: flex-start\"\r\n                     v-if=\"item.fromuser === fromUser.toString()\">\r\n                  <!--                åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯ä¸æ˜¯å‘é€è€…ï¼Œå¦‚æœæ˜¯å°±æ‰§è¡Œè¿™ä¸ª-->\r\n                  <img :src=\"item.fromavatar\" alt=\"\"\r\n                       style=\"width: 40px; height: 40px; border-radius: 50%; margin-left: 10px\">\r\n\r\n\r\n                  <div class=\"im-message im-message-right\" v-html=\"item.content\"\r\n                       v-if=\"item.type === 'text'\"></div>\r\n                  <div class=\"im-message\" style=\"padding: 0\" v-if=\"item.type === 'img'\">\r\n                    <!-- æ³¨æ„  el-image çš„loadå‡½æ•°å¿…é¡»åŠ ä¸Šï¼Œå¦åˆ™æ— æ³•è§¦å‘æ»šåŠ¨æ¡åˆ°æœ€åº•ç«¯ -->\r\n                    <el-image style=\"width: 100px\" :src=\"item.content\" alt=\"\"\r\n                              :preview-src-list=[item.content] @load=\"scrollToBottom\"></el-image>\r\n                  </div>\r\n                  <!--                å‘é€çš„æ˜¯æ–‡ä»¶-->\r\n                  <div class=\"im-message im-message-download\" v-if=\"item.type === 'file'\"\r\n                       @click=\"download(item.content)\">\r\n                    <div><i class=\"el-icon-folder-opened\"></i>\r\n                      <span>{{ item.content.substring(item.content.indexOf('-') + 1) }}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                </div>\r\n\r\n                <!--  å·¦è¾¹çš„æ°”æ³¡ -->\r\n                <!--             v-elseè¯´æ˜ä¸¤ä¸ªäº’æ–¥çš„æ¥æ”¶è€… -->\r\n                <div style=\"display: flex; align-items: flex-start\" v-else>\r\n                  <!--                å¤´åƒ-->\r\n                  <img :src=\"item.fromavatar\" alt=\"\"\r\n                       style=\"width: 40px; height: 40px; border-radius: 50%; margin-right: 10px\">\r\n                  <div style=\"width: 100%\">\r\n                    <div style=\"color: #888; font-size: 12px; width: 50%\">\r\n                      <!--                    å†…å®¹å·¦ä¾§äººå-->\r\n                      {{ toUserName }}\r\n                    </div>\r\n                    <!--                  å‘é€çš„æ˜¯æ–‡å­—-->\r\n                    <div class=\"im-message im-message-left\"  v-html=\"item.content\"\r\n                         v-if=\"item.type === 'text'\"></div>\r\n                    <!--                  å‘é€çš„æ˜¯å›¾ç‰‡-->\r\n                    <div class=\"im-message\" style=\"padding: 0\" v-if=\"item.type === 'img'\">\r\n                      <!-- æ³¨æ„  el-image çš„loadå‡½æ•°å¿…é¡»åŠ ä¸Šï¼Œå¦åˆ™æ— æ³•è§¦å‘æ»šåŠ¨æ¡åˆ°æœ€åº•ç«¯ -->\r\n                      <el-image style=\"width: 100px\" :src=\"item.content\" alt=\"\"\r\n                                :preview-src-list=[item.content]\r\n                                @load=\"scrollToBottom\"></el-image>\r\n                    </div>\r\n                    <!--                  å‘é€çš„æ˜¯æ–‡ä»¶çš„è¯-->\r\n                    <div class=\"im-message im-message-download\" v-if=\"item.type === 'file'\"\r\n                         @click=\"download(item.content)\">\r\n                      <div><i class=\"el-icon-folder-opened\"></i>\r\n                        <span>{{ item.content.substring(item.content.indexOf('-') + 1) }}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- è¾“å…¥åŒºåŸŸ -->\r\n          <div style=\"padding: 10px 5px; border-top: 1px solid #ddd; display: flex; align-items: center; width: 100%;\">\r\n            <!--            è¡¨æƒ…åŒ…-->\r\n            <el-popover placement=\"top\" width=\"300\" trigger=\"click\">\r\n              <div class=\"emoji-box\">\r\n                <span v-for=\"(item, index) in emojis\" :key=\"index\"\r\n                      style=\"margin-right: 5px; font-size: 20px; cursor: pointer\" v-html=\"item\"\r\n                      @click=\"clickEmoji(item)\">\r\n                </span>\r\n              </div>\r\n              <i slot=\"reference\" class=\"fa fa-smile-o\" style=\"font-size: 22px; color: #666;\"></i>\r\n            </el-popover>\r\n            <!--            ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶-->\r\n            <div style=\"margin-left: 5px\">\r\n              <el-upload action=\"http://47.109.28.131:9090/files/upload\" :show-file-list=\"false\" :on-success=\"handleFile\">\r\n                <i class=\"fa fa-folder-open-o\" style=\"font-size: 20px; color: #666;\"></i>\r\n              </el-upload>\r\n            </div>\r\n            <!--è¾“å…¥æ¡†-->\r\n            <div\r\n                id=\"im-content\"\r\n                contenteditable\r\n                @keydown.enter.prevent\r\n                @keyup.enter=\"send\"\r\n                style=\"flex: 1; background-color: #fff; margin: 0 5px;max-height: 50px;overflow-y: auto;padding: 10px; border: 1px solid #ddd; border-radius: 2px; outline: none; font-size: 18px;\"\r\n            ></div>\r\n            <el-button type=\"primary\" @click=\"send\" style=\"border: none\">å‘é€</el-button>\r\n\r\n          </div>\r\n\r\n        </div>\r\n        <!--  ä¸­é—´éƒ¨åˆ†ç»“æŸ  -->\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\nimport emojis from \"@/assets/emoji\";\r\n\r\nlet client\r\nexport default {\r\n  data() {\r\n    return {\r\n      user: {},\r\n      permission: [],\r\n      emojis: [],\r\n      messages: [],\r\n      users: {},\r\n      fromUser: '',// å½“å‰ç”¨æˆ·\r\n      toUser: '',\r\n      toAvatar: '',\r\n      unRead: {},\r\n      toUserName:'',\r\n      timeIntervalThreshold: 3 * 60 * 1000\r\n    }\r\n  },\r\n  computed:{\r\n    groupedMessages() {\r\n      const grouped = {};\r\n      this.messages.forEach(item => {\r\n        const date = item.time.split(' ')[0]; // æå–æ—¥æœŸéƒ¨åˆ†\r\n        if (!grouped[date]) {\r\n          grouped[date] = [];\r\n        }\r\n        grouped[date].push(item);\r\n      });\r\n      return grouped;\r\n    },\r\n  },\r\n\r\n  // é¡µé¢åŠ è½½çš„æ—¶å€™ï¼Œåšä¸€äº›äº‹æƒ…ï¼Œåœ¨createdé‡Œé¢\r\n  mounted() {\r\n    this.emojis = emojis.split(',')\r\n    this.user = JSON.parse(localStorage.getItem('xm-user') || \"{}\")\r\n\r\n    this.fromUser = this.user.id\r\n    this.fromUser = this.fromUser + \"\"\r\n    // å­—ç¬¦ä¸²å­˜å‚¨\r\n    let id = this.user?.id.toString();\r\n    client = new WebSocket(`ws://47.109.28.131:9090/imserverSingle/${id}`)\r\n    client.onopen = () => {\r\n      console.log('websocket open')\r\n    }\r\n    client.onclose = () => {  // é¡µé¢åˆ·æ–°çš„æ—¶å€™å’Œåå°websocketæœåŠ¡å…³é—­çš„æ—¶å€™\r\n      console.log('websocket close')\r\n    }\r\n    client.onmessage = (msg) => { //WebSocket å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œç”¨äºå¤„ç†ä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚\r\n      if (msg.data) { // æ£€æŸ¥æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯å¦å­˜åœ¨ã€‚\r\n        let json = JSON.parse(msg.data)\r\n        if (json.users && json.users.length){\r\n          this.loadOnline();\r\n          return\r\n        }\r\n      if(json.touser === this.fromUser.toString()){\r\n        this.loadOnline();\r\n      }\r\n        if (json.content && (json.fromuser === this.fromUser.toString() && json.touser === this.toUser.toString())\r\n            || json.touser === this.fromUser.toString() && json.fromuser === this.toUser.toString()) {  // è¯´æ˜æ˜¯ä¸¤è€…äº’ç›¸å‘æ¶ˆæ¯\r\n          this.messages.push(json) //æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—é‡Œ\r\n          this.scrollToBottom()  // æ»šåŠ¨é¡µé¢åˆ°æœ€åº•éƒ¨\r\n          this.loadOnline();\r\n        }\r\n        // åŠ è½½æ¶ˆæ¯æ•°å­— ä¸¤è€…é€šä¿¡å¦‚æœæ˜¯å¯¹é¢å‘æ¥çš„æ¶ˆæ¯ è¯´æ˜å½“å‰æ­£åœ¨ä¸¤ä¸ªäººçš„é€šä¿¡çª—å£\r\n        if (this.toUser.toString() === json.fromuser) {\r\n          this.setUnReadNums()  // æŠŠå¯¹æ–¹æ¶ˆæ¯è®¾ä¸ºå·²è¯»,æ›´æ–°æœªè¯»æ¶ˆæ¯æ•°é‡\r\n          this.loadOnline();\r\n        } else {  //ç”¨æˆ·å‘ç»™å¯¹æ–¹çš„\r\n          // å¯èƒ½æ˜¯å½“å‰ç”¨æˆ·å‘ç»™å¯¹æ–¹çš„æ¶ˆæ¯ï¼Œæˆ–è€…æ˜¯å…¶ä»–äººé€šä¿¡ éƒ½ åŠ è½½å½“å‰ç”¨æˆ·çš„æœªè¯»æ¶ˆæ¯æ•°é‡ æ¯æ¬¡ç›‘å¬åˆ°é€šä¿¡äº‹ä»¶å°±æ›´æ–°æœªè¯»è®°å½•\r\n          this.loadUnReadNums()\r\n          this.loadOnline();\r\n        }\r\n      }\r\n    }\r\n\r\n    // åŠ è½½èŠå¤©æ•°æ®\r\n    this.load()\r\n    this.loadOnline()\r\n    request.get('/user/selectAllOnline?userId='+ this.user.id.toString()).then(res => {\r\n      //è¿‡æ»¤æ‰è‡ªå·±å°±å¯ä»¥ //å®æ—¶åˆ·æ–°\r\n      res.data = res.data.filter(v => v.id  !== this.user.id )\r\n      this.$set(this.users, 'USER', res.data)\r\n    })\r\n\r\n\r\n  },\r\n  // Vueå®ä¾‹é”€æ¯ä¹‹å‰æ‰§è¡Œ  é‡Šæ”¾èµ„æº\r\n  beforeDestroy() {\r\n    if (client) {\r\n      client.close()\r\n    }\r\n  },\r\n  // å®šä¹‰ä¸€äº›é¡µé¢ä¸Šæ§ä»¶å‡ºå‘çš„äº‹ä»¶è°ƒç”¨çš„æ–¹æ³•\r\n  methods: {\r\n    //\r\n    shouldDisplayTime(index, group) {\r\n      if (index === 0) {\r\n        return true;\r\n      }\r\n      const currentTime = new Date(group[index].time).getTime();\r\n      const prevTime = new Date(group[index - 1].time).getTime();\r\n      return currentTime - prevTime > this.timeIntervalThreshold;\r\n    },\r\n    load() {\r\n      request.get('/imsingle?fromUser=' + this.fromUser.toString() + '&toUser=' + this.toUser.toString()).then(res => {\r\n        // console.log(res)\r\n        if (res.code === '200') {\r\n          //æŠŠå¯¹æ–¹æ¶ˆæ¯è®¾ä¸ºå·²è¯» è¿™æ˜¯ä¸¤è€…çš„æ¶ˆæ¯ä¼ é€’\r\n          this.messages = res.data\r\n          this.scrollToBottom()  // æ»šåŠ¨æ¡æ»šåŠ¨åˆ°æœ€åº•éƒ¨\r\n        } else {\r\n           this.$notify.error(res.msg)\r\n        }\r\n        this.loadUnReadNums()\r\n      })\r\n    },\r\n    // æŸ¥è¯¢ä¸¤ä¸ªäººçš„æ‰€æœ‰æ¶ˆæ¯ åŒæ—¶æŠŠ å¯¹æ–¹ çš„æ¶ˆæ¯è®¾ä¸ºå·²è¯»\r\n    setUnReadNums() {\r\n      request.get('/imsingle?fromUser=' + this.fromUser.toString() + '&toUser=' + this.toUser.toString()).then(res => {\r\n        this.loadUnReadNums()\r\n      })\r\n    },\r\n    // æŸ¥è¯¢å½“å‰ç”¨æˆ·çš„æ‰€æœ‰æœªè¯»æ•°é‡å¹¶æ ‡è®°\r\n    loadUnReadNums() {\r\n      request.get('/imsingle/unReadNums?toUsername=' + this.fromUser.toString()).then(res => {\r\n        this.unRead = res.data\r\n        // console.log(this.unRead)STUDENT_æ± :2\r\n      })\r\n    },\r\n    //æŸ¥è¯¢æ‰€æœ‰çš„åœ¨çº¿äººæ•°\r\n    loadOnline(){\r\n      // æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦åœ¨çº¿\r\n      // '/imsingle/unReadNums?toUsername=' + this.fromUser.toString()\r\n      request.get('/user/selectAllOnline?userId='+ this.user.id.toString()).then(res => {\r\n        //è¿‡æ»¤æ‰è‡ªå·±å°±å¯ä»¥ //å®æ—¶åˆ·æ–°\r\n        res.data = res.data.filter(v => v.id  !== this.user.id )\r\n        this.$set(this.users, 'USER', res.data)\r\n      })\r\n    },\r\n\r\n    //å‘é€æ¶ˆæ¯\r\n    send() {\r\n      let inputBox = document.getElementById('im-content') //è¾“å…¥æ¡†è¾“å…¥çš„ä¸œè¥¿è¿›è¡Œè·å–\r\n      const content = inputBox.textContent.trim(); // ä½¿ç”¨ trim() å»é™¤ä¸¤ç«¯ç©ºç™½å­—ç¬¦\r\n\r\n      if (content.length === 0) {\r\n        this.$notify.error('è¯·è¾“å…¥èŠå¤©å†…å®¹!');\r\n        return;\r\n      } else if (content.length > 150) {\r\n        this.$notify.error('å­—æ•°è¶…è¿‡150ï¼Œè¯·é‡æ–°è¾“å…¥!');\r\n        return;\r\n      }\r\n\r\n\r\n      if (!this.toUser) {\r\n        this.$notify.error('è¯·é€‰æ‹©èŠå¤©ç”¨æˆ·')\r\n        return\r\n      }\r\n      if (client) {\r\n        let message = this.getMessage('text')\r\n        client.send(JSON.stringify(message))\r\n      }\r\n      document.getElementById('im-content').innerHTML = ''  // æ¸…ç©ºè¾“å…¥æ¡†\r\n    },\r\n    //é€‰æ‹©å¯¹æ–¹å¹¶æŸ¥è¯¢ä¸¤ä¸ªäººçš„æ‰€æœ‰æ¶ˆæ¯ åŒæ—¶æŠŠ å¯¹æ–¹ çš„æ¶ˆæ¯è®¾ä¸ºå·²è¯» æ›´æ–°æ‰€æœ‰æœªè¯»è®°å½•\r\n    selectToUser(item) {\r\n      console.log(this.user.id)\r\n      if(this.user.id.toString() === '10'){\r\n        this.$notify.error(\"è®¿å®¢æ— æƒæŸ¥çœ‹ï¼Œè¯·æ³¨å†Œè´¦å·å“¦\")\r\n        return\r\n      }\r\n      //è®¾ç½®å‘é€çš„äººä»¥åŠå¯¹æ–¹çš„å¤´åƒ\r\n      this.toUserName = item.name\r\n      this.toUser = item.id \r\n      this.toAvatar = item.avatar\r\n      //æŸ¥è¯¢èŠå¤©è®°å½• åŒæ—¶æŠŠå¯¹æ–¹æ¶ˆæ¯çš„è®¾ä¸ºå·²è¯»\r\n      this.load()\r\n    },\r\n    //ä¸‹è½½æ–‡ä»¶\r\n    download(file) {\r\n      window.open(file)\r\n    },\r\n    //å‘é€çš„ä¿¡æ¯\r\n    getMessage(type) {\r\n      let inputBox = document.getElementById('im-content') //è¾“å…¥æ¡†è¾“å…¥çš„ä¸œè¥¿è¿›è¡Œè·å–\r\n      const content = inputBox.innerHTML\r\n      if (!content && type === 'text') { //æ²¡æœ‰èŠå¤©å†…å®¹\r\n        this.$notify.error('è¯·è¾“å…¥èŠå¤©å†…å®¹')\r\n        return\r\n      }\r\n      return {\r\n        fromuser: this.fromUser,//è‡ªå·±\r\n        fromavatar: this.user.avatar,\r\n        touser: this.toUser,\r\n        toavatar: this.toAvatar,\r\n        content: content,\r\n        type: type\r\n      }\r\n    },\r\n    // è®¾ç½®æ–‡ä»¶ç±»å‹ æ˜¯å›¾ç‰‡è¿˜æ˜¯æ–‡ä»¶ å‘é€æ–‡ä»¶\r\n    handleFile(file) {\r\n      if (client) {\r\n        let message = this.getMessage('img')\r\n        message.content = file.data\r\n        //è¿™æ˜¯ä¸€ä¸ªåœ°å€\r\n        let extName = file.data.substring(file.data.lastIndexOf('.') + 1)\r\n        if (['png', 'jpg', 'jpeg', 'gif', 'bmp', 'tiff', 'svg', 'webp','jfif'].includes(extName)) {\r\n          message.type = 'img'\r\n        } else {\r\n          message.type = 'file'\r\n        }\r\n        client.send(JSON.stringify(message))\r\n      }\r\n    },\r\n    //è®¾ç½®å‘é€çš„è¡¨æƒ…\r\n    clickEmoji(emoji) {\r\n      document.getElementById('im-content').innerHTML += emoji\r\n    },\r\n    //æ»šåŠ¨åˆ°æœ€åº•éƒ¨\r\n    scrollToBottom() {\r\n      this.$nextTick(() => {\r\n        // è®¾ç½®èŠå¤©æ»šåŠ¨æ¡åˆ°åº•éƒ¨\r\n        let imMessageBox = document.getElementsByClassName(\"im-message-box\")[0]\r\n        //è®¾ç½®æ»šåŠ¨æ¡åˆ°æœ€åº•éƒ¨\r\n        imMessageBox.scrollTop = imMessageBox.scrollHeight\r\n        console.log('è§¦å‘æ»šåŠ¨')\r\n      })\r\n    },\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n</script>\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n.im-message-box {\r\n  height: 50vh;\r\n  padding: 10px;\r\n  overflow-y: auto;\r\n  background-color: white;\r\n}\r\n\r\n.emoji-box {\r\n  height: 200px;\r\n  overflow-y: scroll;\r\n  line-height: 30px;\r\n}\r\n\r\n.user-list-box {\r\n  overflow-y: auto;\r\n}\r\n\r\n.im-message-box::-webkit-scrollbar, .emoji-box::-webkit-scrollbar, .user-list-box::-webkit-scrollbar {\r\n  width: 4px;\r\n}\r\n\r\n.im-message-box::-webkit-scrollbar-thumb, .emoji-box::-webkit-scrollbar-thumb, .user-list-box::-webkit-scrollbar-thumb {\r\n  border-radius: 10px;\r\n  background: rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.im-message-box::-webkit-scrollbar-track, .emoji-box::-webkit-scrollbar-track, .user-list-box::-webkit-scrollbar-track {\r\n  border-radius: 0;\r\n  background: rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.im-message {\r\n  font-size: 14px;\r\n  padding: 10px;\r\n  margin: 5px 0;\r\n  border-radius: 5px;\r\n  color: #000;\r\n  max-width: 50%;\r\n  line-height: 20px;\r\n  width: fit-content;\r\n}\r\n\r\n.im-message-left {\r\n  background-color: #fff;\r\n\r\n}\r\n\r\n.im-message-right {\r\n  background-color: #26d470;\r\n}\r\n\r\n.im-message-download {\r\n  background-color: #DBEDFF;\r\n  cursor: pointer;\r\n}\r\n\r\n.user-list-item {\r\n  display: flex;\r\n  padding: 10px;\r\n  align-items: center;\r\n  border-bottom: 1px solid #eee;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\n.user-list-item-badge {\r\n  padding: 2px 6px;\r\n  border-radius: 10px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 12px;\r\n  color: white;\r\n  background-color: red;\r\n}\r\n.header{\r\n  padding: 10px;\r\n  border-bottom: 1px solid #ddd;\r\n  color: #000;\r\n  background-color: #eee;\r\n  font-weight: bold;\r\n  text-align: center\r\n\r\n}\r\n.user-list-item:nth-last-child(1) {\r\n  border: none;\r\n}\r\n\r\n.online {\r\n  width: 30px;\r\n  height: 30px;\r\n  border-radius: 50%;\r\n  border: 2px solid #4CAF50;\r\n  background-color: #4CAF50;\r\n}\r\n\r\n.offline {\r\n  width: 30px;\r\n  height: 30px;\r\n  border-radius: 50%;\r\n  border: 2px solid #ccc;\r\n  background-color: #ccc;\r\n}\r\n\r\n.online-text {\r\n  color: #4CAF50;\r\n}\r\n\r\n.offline-text {\r\n  color: gray;\r\n}\r\n\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ImSingle.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ImSingle.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ImSingle.vue?vue&type=template&id=780ef200&scoped=true\"\nimport script from \"./ImSingle.vue?vue&type=script&lang=js\"\nexport * from \"./ImSingle.vue?vue&type=script&lang=js\"\nimport style0 from \"./ImSingle.vue?vue&type=style&index=0&id=780ef200&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"780ef200\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","staticStyle","_v","_l","users","USER","item","on","$event","selectToUser","class","online","info","offline","attrs","avatar","style","color","id","toString","toUser","_s","name","unRead","_e","toUserName","groupedMessages","group","date","key","index","shouldDisplayTime","domProps","time","fromuser","fromUser","fromavatar","type","content","scrollToBottom","download","substring","indexOf","emojis","clickEmoji","slot","handleFile","_k","keyCode","preventDefault","send","apply","arguments","staticRenderFns","client","data","user","permission","messages","toAvatar","timeIntervalThreshold","computed","grouped","forEach","split","push","mounted","JSON","parse","localStorage","getItem","WebSocket","onopen","console","log","onclose","onmessage","msg","json","length","loadOnline","touser","setUnReadNums","loadUnReadNums","load","request","get","then","res","filter","v","$set","beforeDestroy","close","methods","currentTime","Date","getTime","prevTime","code","$notify","error","inputBox","document","getElementById","textContent","trim","message","getMessage","stringify","innerHTML","file","window","open","toavatar","extName","lastIndexOf","includes","emoji","$nextTick","imMessageBox","getElementsByClassName","scrollTop","scrollHeight","component"],"sourceRoot":""}